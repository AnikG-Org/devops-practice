import "tfconfig"

check_for_stray_resources = func(){
    if length(tfconfig.module([]).resources) > 0 {
        print("Individual resources have been created. All resources should be consumed through modules from approved sources.")
        return false
    } else {
        print("No individually defined resources present.")
        return true
    }
}

no_individual_resources = rule {
    check_for_stray_resources() is not false
}

main = rule {
    no_individual_resources
}